language: objective-c
osx_image: xcode7.3
before_install:
- brew update
- brew install tailor
- gem install fir-cli
script:
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/profile/$PROFILE_NAME.mobileprovision.enc
  -d -a -out scripts/profile/$PROFILE_NAME.mobileprovision
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.cer.enc -d -a
  -out scripts/certs/dist.cer
- openssl aes-256-cbc -k "$ENCRYPTION_SECRET" -in scripts/certs/dist.p12.enc -d -a
  -out scripts/certs/dist.p12
- ./scripts/add-key.sh
- xctool -workspace $APP_NAME.xcworkspace -scheme $APP_NAME -sdk iphoneos  -configuration Release OBJROOT=$PWD/build   SYMROOT=$PWD/build CODE_SIGN_IDENTITY="$DEVELOPER_NAME" ONLY_ACTIVE_ARCH=NO
- rm -rf ~/Library/Developer/Xcode/DerivedData
- xcodebuild clean build test -workspace $APP_NAME.xcworkspace -scheme $APP_NAME -sdk iphonesimulator -destination 'platform=iOS Simulator,name=iPhone 6,OS=9.2' OTHER_SWIFT_FLAGS=" -D UITEST"  | xcpretty
after_success:
- bash <(curl -s https://codecov.io/bash)
- ./scripts/sign-and-upload.sh
after_script:
- ./scripts/remove-key.sh
include:
- CavyLifeBand2
env:
  global:
  - APP_NAME="CavyLifeBand2"
  - 'DEVELOPER_NAME="iPhone Distribution: Hangzhou Cavy Technology Co., Ltd."'
  - PROFILE_NAME="CavyLifeBand2"
  - secure: XPIWQOCQYpJ3+vkCiKk9K5f9QXiIApujSTDb1ETjZbR4RXkKNK3hN5Vj9w/RkdCPoB7w30494hEbUkWxFtcOn6YSOY+8HmitKzOb1D9Fxn19qaMRibV3x3bG3/Oqu985JdUqsLhKN48IIUubI3b/Zkwt7Rjgfuh0K7xBHqP/VSPcBs2GtAMRNyWKv+b9QonP21O1nUUapDwxi0Bo+NmjusUDIW2sj2F5X7hRA77y8Cxl31TkhPaQ2/beYGMLyxCxF5mNcXQmb3FfFFmIj/hCJNDD0+5KyzlGx+qf0ZKIi44YyI7oI0u2g/JARnv222h7NRMhyaf+mS8ydxkL0KRw3TVTAoYZ5S6dFtHCK4StZ4XZDThfyDhnudb28JkD0UHq706dFZ9NQIbJg8LZqKzRlj18ArcyXd2Mm8IJ5POB0y9qj6cdRNJmJxL1rfwveyZg1QrdCCAdUEvYG+ItB3egDkeWNSU7NxrooGWK7jWc27zd58BCgORVrmFp1l1t8l4ktz4faGRPxnCmVGsy1+9Ngup7LFzLs3ZE0e59furpgmAXZndfE/t/XXHu/dUWvGwG1IEkMZ/IQ8cMNhmNH00OsdEUFbWC5AI/Vz89AkunDS40h6u82pt9UvqpV/oBJZKoC0jvHZ6hx1H/y9WOkiJvuaIvwSoeVBdU00G3VKmo2VI=
  - secure: XMbBJowLvR1xwemFO7/Sp+lrIpOaQBPvWfypBoNscke/f42G5vdO9bAJocEDTM0jSHIS0HqAbyNnLaJ5fV5PUV2JRKhN55Se4CcyorlD0ySmsODvZDZWWhtMgvay/hdgXUpS+zDlIdZbge/+IHxY8zJ1BmZmELUxwEL3kzOm5XaKKYR0sCQOQHaYuWJvXWPxqFr8x9eiaQRLw4aW4efeghKNtQAbCUbi0IyjXps0NfW4pvQrnNRbZPvL/0C1NYDXFJdxacaWZAFDuNisojWRjtqa97vBNY7F8onIVoSBXqrGfeVJ+Uj6Kl5EjliY1pW//gvUbCWa+c5Q4gjISAXDyWyRHoA5m3C3aSi4QGWewdgQaUQYTLOr/qTs88rLk8OI6Ohl9R3vZU3u6y4+tLKnCK7x3zcJdTmfbsIwATA/iKbvWpKjdt5QA1eUj2PM9GKTGqTsjNxoyXHIv9utejW4RZ7dUvFnNw916L4+wQ6e7WEp1lXWzK1MlxjhT+LQTpVt7xubbGUIya7oPP6z0nvQd61aRg1zKEwA/h0vE7LWW4UxUe7spdXSrx/lNJuGVYTrge8UZndBJq3Au2HFaA1nEYFFpWoAzBGzw81DxlhRSjOvqH8CNuE7x+q115r56AnaxuV7S2CbFuRf3VOMdkmihknkEJKJ3/9PSHmudDzhAGI=
  - secure: YfANqrntMM4ZBIyM1Iv7Xi4jy5j/oK+jJTZc7FQ5WF6P5KyTTDQ+esRJWY05hxyAydzlkuAcrGyEV1SmZ9mEIp2AUNTCXUzpXcnCWeMluIgTgWIScNUl6fsUCnS1gl00hZtRcUVJXJLS//FBeXKKAZzKMnM3Y8hAfsWF30OPLJEH450+Wh2Y1DIxMUNY0H8Yx0E/I5J+sdZ7iPyRswUxJz7PP36b46JCvLpKIcAKuY9G5ZEJstxKrXjH/kAO2UPqdHTzkGPTL+04wtq8ENdm7ncwtthn0XtQik4TIBQAx07nVaf7dGqsjdvbMTTK8O+gVC8D+GrMsw7buzaKT197kPRA8ml83y5YTBC/KjzqhUag3krhab5LMyU9WYOUdyBu7zCv4pNwOxwVn8wGCfOOp3ontMih0DIPXtKP9fKEf6WyNw//q/O0jNhYzLVR/IKozhtkRs9O5i2nnu4AXS2f/devaiqzkyStlOViyKcmZZx+EnAy5iaNoPg90w2wWVOry739Nm6YqgJc8X4xphNpFY29S42qHtBPPKcAd8utDQtedremQSle4QMqloRX3m2Q7CzyV5pmvTEz0m4C7vvjxxqbz6L0Uy4Lw++879LfOM5YIrCyxYlLiLdC7kY2WSSAAhPwc2iGcLW7BL/oAcdtEH9evVg3utmGEDHOBX9mSsE=
  - secure: jLcqceUJ2+Nsk+/r2rMbhiuqLigAcdfTmZB9aASrASdIjcxVra2u75xVaPXq5yKjhm3I9S6uYLI26/4zo1wWQwc70xH5tBNeDMs5+FyCUN3trfUw0FLxg7/Xtw4Ti95Qw6rMkVmhCRjnjJ3Z+NwQ4mjCnkVNSuEIhD4qkK7tgJTpfieGydMyfhDtEWVDBgSV12HmdADOFjYqvCkPS1OX9hHzE2ouHrxyT2N25LNIu0VmjofT+g6fnAmOu1UufsreDEMKAKthG3pDyrpzId8sQgeOESSmvQw1Oki2iVhPXwql+SYgCOiKAZaZ7TN6RzeW+lIxP+DQl37uc0WEUPhv+enNMGHtmp5hrlTJja8iiwKjwb01kSZhSeeNgYzb3nz42LzZebm/EZEDnVO9ublOgYLnSvWF/GGVeHssA70hi1MYwbqHWps47e/RgcLPajc6cdDkNf/Fu2wM/bIceaQnuspKTpx6LMV3yo/CSwkAR+Y63cDkvpFqhdKEz693YKJNHx7aG8Ad96hcLpb8eDLZhhJDqOufrk3zZdBCtoCFuFoJlLWg9NFUlkzAZ9XGp8RgMlY5+TJm2GKpAddqpbTceSCXdnMl6jRfoA2LbSN8m3Dr4dt0V89WNP0lYPvHoZgDA/Nx/Wbyixf8K6KVrbDYEXKP0uH6yVxaXXSfrWX21Jw=
  - secure: IaOp3ITe4ecUYtAomrBD9mbDIgOb3uryCw5iWSqhlt9oovB70ZO7x5OtydFBTrTRD4C/SjtVc3T6o2i/4ocz3+1HMcPGKXpzmEOTJBViwY8Yx7iW3lwZQT8GW5Yu+tyGoWax44TCTlY1CcYU3Bw89iiiOeV1t+OPhzSkoYzB4R6mVU3VtENQzEnstP19UHyhmRat+PSP1eujemXPunnjWEyU46axFO26X5BlUIPldPXEkK1D/T7XzcZZ0ssL8Nd682SyQe8fAhat3kGiDLcBXEaq8MkqyuZdue/pPIaSF08mCwGYC+4JvyBcF5ZZBiPFxQ2neUIakDnLJgyfe2OrnPfshkNfsGlrvbXTnI2X8g16H5DQGVDuEsg7EoVoyJn10s5EuU7842o8u11K7xsPlBSaKtJV5QRuTO4g8C9RAJJUc8KzMDb/7mQLjm4gDxCZsguq3Q0bMa8VQEQQif/Z9dQf/JHiRQw1c+bMYUSsNfE744IF3RV9DTFMC60UJVEKZdYi2mt79gRhr5TZQVP3ZWSHKQw1nviQkrkE653WJnrgvMcIKgOjVqrMv3qQaoRQyG7xbE6y3miti9dgbUZjoBolDEa1UgKyiygNjp/wL+16OgM34YPgt8MJVtHSmy7dqaFSyoseIl3ClK673WasrtCFFhgzEJqUT/q1n4uZy9Y=
  - secure: r5PqFZQE9+Bd7BKTIAH5HrR/R2vDCN7zvuSaZSBVCssNk8u9T2kIr+6wW0CJ6v9HT5zvB+Alufk4EnTpSIqcFg0l4ifbMuG9ZejmVZsbu9UBAvL4yEmNXN5AOlXnqLSV48Ly9LRloFFLII9dfJiYIZVn8oQe47pw+hOabiVX7Q0HbjoOsrBFvCIatrggcZCpCD7YcN/g/k42R4Ngux3gv5whwzak1O/SraTwOFqP7JMQr3rWJ/b3dmwRI/hfiEQcwz0Jxhf0t/vZO30Y1uGee8vsGKfAP3F9/2rwJWHwJETOpcrgwjlJbBG9gSdPXuSPlBfDJPDulU3ydmfOSmlZHSlapvUsoReuV+9LfJBGOlbYiTOwIT5Hwfd3ncx02p8C5EAKUGDDldfRsiM8f/LD2s8ZIl00jDijAhMKnnmZ1YlNVesZhlwawf5XW8wJ0meEYlCfGk5Z5SfiTdP0DqfbxjtRpKASs8YNst7PbT7Pg8T9e9nAngD3aqMsQmcNsen1rluCaBwhH1vU6He47Kty1B2/3/ZUXwbkvo7DzGCxYKwLpwOEv6BTfFmz5RbTDYVMxMNG3gzsoyEsDO3sW763Rnlucs3JrsAyo29gx6hlnlUEkbSQOJZf+a+5SrPIuxb3/6H56YCihotVkUW+7pupexwBxjLG6yZqDheI/2xMDKQ=
